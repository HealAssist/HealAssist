package database.access.facade;

import java.sql.PreparedStatement;
import java.util.HashMap;
import java.util.Iterator;

import database.access.dataobject.AbstractTable;

public class QueryBuilder {
	public static String constructInsert(AbstractTable table){
		try{
			String tableName = table.getTableName();				
			String[] attrList = (String[]) table.getAttributeMap().keySet().toArray();
			HashMap<String, String> attrCollection = table.getAttributeMap();
			String attrNames = " ( ";
			String attrValues = " ( ";	
			String statement = 
					"INSERT INTO " + tableName; 											
					
			// *** modify for non-string values (vals that don't need ' ', 
			// i.e, (fName, lName) Values ('John', 'Doe')			
			attrNames += attrList[0];
			attrValues += attrCollection.get( attrList[0] );
			for(String attribute: attrList){
				attrNames += ", " + attribute;
				attrValues += ", " + attrCollection.get(attribute);				
			}
			attrNames += " ) ";
			attrValues += " ) ";
			
			statement+= attrNames + " VALUES " + attrValues; // *** Ensure ; isn't needed @ stmt end
			
		}catch(Exception e){
			System.out.println(e.toString());
			return null;
		}
	}
}
