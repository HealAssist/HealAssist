package database.access.tableobject;

import java.util.HashMap;

public class DatabaseTable {
	private String tableName;
	private HashMap<String, String> attributeList;	
	
	public DatabaseTable(){
		this.tableName = "";
		this.attributeList = new HashMap<String, String>();
	}
	public HashMap<String, String> getAttributeMap(){
		return this.attributeList;
	}
	public String[] formatAttrForWhere(){		
		if(attributeList.isEmpty()){
			return null;
		}else{
			String[] keys = attributeList.keySet().toArray(new String[0]);
			String[] results = new String[keys.length];
			for(int i = 0; i < keys.length; i++){
				results[i] = keys[i] + " = " + attributeList.get(keys[i]);
			}
			return results;
		}
	}
	public String[] getColumnNames(){
		return this.attributeList.keySet().toArray(new String[0]);
	}
	private void addAttribute(String attrKey, String attrValue){
		this.attributeList.put(attrKey, attrValue);
	}
	
	public String getTableName(){
		return this.tableName;
	}
	protected void setTableName(String newTableName){
		this.tableName = newTableName;
	}

	protected void addStrAttr(String attrName, String attrValue){
		String formStrAttr = this.formatStringAttr(attrValue);
		this.addAttribute(attrName, formStrAttr);		
	}
	protected void addNumAttr(String attrName, String attrValue){
		this.addAttribute(attrName, attrValue);
	}
	protected void addCharAttr(String attrName, String attrValue){
		String formCharAttr = this.formatCharAttr(attrValue);
		this.addAttribute(attrName, formCharAttr);
	}
	
	private String formatStringAttr(String attrValue){
		return "'" + attrValue + "'";
	}
	private String formatCharAttr(String attrValue){
		return "'" + attrValue + "'";
	}
	
	public Boolean hasAttributes(){
		if( this.attributeList.size() <= 0 ){
			return false;
		}else{
			return true;
		}
	}
	
}
